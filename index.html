<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>VENORA PRO - Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª Ø§Ù„Ù…ØªÙƒØ§Ù…Ù„</title>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root { --dark-bg: #1a1a2e; --card-bg: #16213e; --pink: #d63384; --green: #27ae60; --blue: #0984e3; --text: #ffffff; }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { font-family: 'Tajawal', sans-serif; margin: 0; background: var(--dark-bg); color: var(--text); transition: 0.3s; }
        header { background: #111; padding: 10px; display: flex; align-items: center; border-bottom: 3px solid var(--pink); position: sticky; top: 0; z-index: 1000; }
        .nav-scroll { display: flex; overflow-x: auto; gap: 10px; padding: 5px; scrollbar-width: none; flex-grow: 1; }
        .nav-item { padding: 8px 15px; border-radius: 8px; color: #ccc; cursor: pointer; white-space: nowrap; font-size: 14px; }
        .nav-item.active { background: var(--pink); color: white; font-weight: bold; }
        .container { padding: 15px; padding-bottom: 80px; }
        .card { background: var(--card-bg); border-radius: 15px; padding: 15px; margin-bottom: 15px; border: 1px solid #252545; box-shadow: 0 4px 10px rgba(0,0,0,0.3); }
        input, select { width: 100%; padding: 12px; margin: 8px 0; border: 1px solid #252545; border-radius: 10px; background: #0f172a; color: white; font-size: 15px; }
        .btn { width: 100%; padding: 14px; border: none; border-radius: 10px; font-weight: bold; cursor: pointer; margin-top: 5px; color: white; transition: 0.2s; }
        .btn-pink { background: var(--pink); }
        .btn-green { background: var(--green); }
        .btn-blue { background: var(--blue); }
        table { width: 100%; border-collapse: collapse; margin-top: 10px; }
        th, td { padding: 12px; text-align: center; border-bottom: 1px solid #252545; font-size: 13px; }
        .hidden { display: none !important; }
        #dev-code-editor { width: 100%; height: 200px; background: #000; color: #0f0; font-family: monospace; padding: 10px; border-radius: 10px; border: 1px solid var(--pink); direction: ltr; }
    </style>
</head>
<body>

    <header>
        <div class="nav-scroll">
            <div class="nav-item active" onclick="showTab('sales', this)">ğŸ›’ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª</div>
            <div class="nav-item" onclick="showTab('inventory', this)">ğŸ“¦ Ø§Ù„Ù…Ø®Ø²Ù†</div>
            <div class="nav-item" onclick="showTab('profits', this)">ğŸ“Š Ø§Ù„Ø£Ø±Ø¨Ø§Ø­</div>
            <div class="nav-item" onclick="showTab('dev', this)">âš™ï¸ Ø§Ù„ØªØ·ÙˆÙŠØ±</div>
        </div>
    </header>

    <div class="container">
        <section id="sales-sec">
            <div class="card">
                <h3>Ø¥Ø¬Ø±Ø§Ø¡ Ø¨ÙŠØ¹ Ø¬Ø¯ÙŠØ¯</h3>
                <select id="s-prod" onchange="updatePriceHint()"></select>
                <input type="number" id="s-qty" value="1" placeholder="Ø§Ù„ÙƒÙ…ÙŠØ©">
                <p id="price-hint" style="color: var(--pink); font-size: 12px;"></p>
                <button class="btn btn-pink" onclick="addToCart()">+ Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ù‚Ø§Ø¦Ù…Ø©</button>
            </div>
            <div class="card">
                <table>
                    <thead><tr><th>Ø§Ù„Ù…Ø§Ø¯Ø©</th><th>Ø§Ù„Ø³Ø¹Ø±</th><th>Ø§Ù„Ø¹Ø¯Ø¯</th><th>Ø­Ø°Ù</th></tr></thead>
                    <tbody id="cart-body"></tbody>
                </table>
                <h2 style="margin: 20px 0; text-align: center;">Ø§Ù„ØµØ§ÙÙŠ: <span id="cart-total" style="color: var(--pink);">0</span> Ø¯.Ø¹</h2>
                <button class="btn btn-blue" onclick="confirmSale()">âœ… Ø¥ØªÙ…Ø§Ù… ÙˆØ­ÙØ¸ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©</button>
            </div>
        </section>

        <section id="inventory-sec" class="hidden">
            <div class="card">
                <h3>Ø¥Ø¶Ø§ÙØ© Ù…ÙˆØ§Ø¯ Ù„Ù„Ù…Ø®Ø²Ù†</h3>
                <input type="text" id="i-n" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø§Ø¯Ø©">
                <input type="number" id="i-q" placeholder="Ø§Ù„ÙƒÙ…ÙŠØ©">
                <input type="number" id="i-c" placeholder="Ø³Ø¹Ø± Ø§Ù„ÙƒÙ„ÙØ©">
                <input type="number" id="i-p" placeholder="Ø³Ø¹Ø± Ø§Ù„Ø¨ÙŠØ¹">
                <button class="btn btn-green" onclick="addInv()">Ø­ÙØ¸ ÙÙŠ Ø§Ù„Ù…Ø®Ø²Ù†</button>
            </div>
            <div class="card">
                <table id="inv-table">
                    <thead><tr><th>Ø§Ù„Ù…Ø§Ø¯Ø©</th><th>Ø§Ù„ÙƒÙ…ÙŠØ©</th><th>Ø§Ù„Ø³Ø¹Ø±</th><th>Ø­Ø°Ù</th></tr></thead>
                    <tbody></tbody>
                </table>
            </div>
        </section>

        <section id="profits-sec" class="hidden">
            <div class="card" style="text-align: center;">
                <h3>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­</h3>
                <h1 id="total-profit" style="color: var(--green);">0 Ø¯.Ø¹</h1>
            </div>
        </section>

        <section id="dev-sec" class="hidden">
            <div class="card">
                <h3>ğŸ› ï¸ Ø¨ÙŠØ¦Ø© Ø§Ù„ØªØ·ÙˆÙŠØ± ÙˆØªØ­Ø¯ÙŠØ« Ø§Ù„ÙƒÙˆØ¯</h3>
                <p style="font-size: 12px; color: #ccc;">Ø¶Ø¹ Ø£ÙƒÙˆØ§Ø¯ JavaScript Ù‡Ù†Ø§ ÙˆØ³ÙŠØªÙ… Ø­ÙØ¸Ù‡Ø§ Ù„Ù„Ø£Ø¨Ø¯:</p>
                <textarea id="dev-code-editor" placeholder="// Ø§ÙƒØªØ¨ ÙƒÙˆØ¯ Ø§Ù„ØªØ·ÙˆÙŠØ± Ù‡Ù†Ø§..."></textarea>
                <button class="btn btn-blue" id="main-update-btn">ğŸš€ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù†Ø¸Ø§Ù… ÙˆØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø£ÙƒÙˆØ§Ø¯</button>
            </div>
        </section>
    </div>

    <script>
        // Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
        let data = JSON.parse(localStorage.getItem('venora_db')) || { inv: [], profits: 0 };
        let cart = [];

        function saveDB() { localStorage.setItem('venora_db', JSON.stringify(data)); }

        function showTab(id, el) {
            document.querySelectorAll('section').forEach(s => s.classList.add('hidden'));
            document.getElementById(id + '-sec').classList.remove('hidden');
            document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
            el.classList.add('active');
        }

        // ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ù…Ø®Ø²Ù† ÙˆØ§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª
        function addInv() {
            const n = document.getElementById('i-n').value, q = parseInt(document.getElementById('i-q').value),
                  c = parseInt(document.getElementById('i-c').value), p = parseInt(document.getElementById('i-p').value);
            if(!n || isNaN(q)) return;
            data.inv.push({id: Date.now(), n, q, c, p});
            saveDB(); render();
            document.querySelectorAll('#inventory-sec input').forEach(i => i.value = '');
        }

        function updatePriceHint() {
            const item = data.inv.find(x => x.id == document.getElementById('s-prod').value);
            document.getElementById('price-hint').innerText = item ? `Ø§Ù„Ø³Ø¹Ø±: ${item.p} | Ø§Ù„Ù…Ø®Ø²ÙˆÙ†: ${item.q}` : '';
        }

        function addToCart() {
            const id = document.getElementById('s-prod').value, qty = parseInt(document.getElementById('s-qty').value),
                  item = data.inv.find(x => x.id == id);
            if(item && qty <= item.q) {
                cart.push({...item, cartQty: qty});
                render();
            } else alert("Ø§Ù„ÙƒÙ…ÙŠØ© ØºÙŠØ± Ù…ØªÙˆÙØ±Ø©!");
        }

        function confirmSale() {
            if(!cart.length) return;
            cart.forEach(c => {
                const i = data.inv.find(x => x.id === c.id);
                if(i) { i.q -= c.cartQty; data.profits += (c.p - i.c) * c.cartQty; }
            });
            cart = []; saveDB(); render();
            alert("ØªÙ…Øª Ø§Ù„Ø¹Ù…Ù„ÙŠØ© Ø¨Ù†Ø¬Ø§Ø­");
        }

        function render() {
            // Ø±Ù†Ø¯Ø± Ø§Ù„Ù…Ø®Ø²Ù†
            const invBody = document.querySelector('#inv-table tbody'), select = document.getElementById('s-prod');
            invBody.innerHTML = ''; select.innerHTML = '<option value="">-- Ø§Ø®ØªØ± Ù…Ø§Ø¯Ø© --</option>';
            data.inv.forEach(i => {
                invBody.innerHTML += `<tr><td>${i.n}</td><td>${i.q}</td><td>${i.p}</td><td onclick="delInv(${i.id})">âŒ</td></tr>`;
                select.innerHTML += `<option value="${i.id}">${i.n}</option>`;
            });
            // Ø±Ù†Ø¯Ø± Ø§Ù„Ø³Ù„Ø©
            const cartBody = document.getElementById('cart-body');
            cartBody.innerHTML = ''; let total = 0;
            cart.forEach((item, idx) => {
                total += (item.p * item.cartQty);
                cartBody.innerHTML += `<tr><td>${item.n}</td><td>${item.p}</td><td>${item.cartQty}</td><td onclick="cart.splice(${idx},1);render()">âŒ</td></tr>`;
            });
            document.getElementById('cart-total').innerText = total.toLocaleString();
            document.getElementById('total-profit').innerText = data.profits.toLocaleString() + " Ø¯.Ø¹";
        }

        function delInv(id) { data.inv = data.inv.filter(x => x.id !== id); saveDB(); render(); }

        // --- Ù†Ø¸Ø§Ù… Ø§Ù„Ø­ÙØ¸ Ø§Ù„Ù…Ø¯Ù…Ø¬ ÙˆØ§Ù„Ø°ÙƒÙŠ Ù„Ù„ØªØ·ÙˆÙŠØ± ---
        const DEV_KEY = 'venora_permanent_dev_code';
        
        document.getElementById('main-update-btn').onclick = function() {
            const code = document.getElementById('dev-code-editor').value;
            try {
                new Function(code)(); // ØªÙ†ÙÙŠØ° Ø§Ù„ÙƒÙˆØ¯
                localStorage.setItem(DEV_KEY, code); // Ø§Ù„Ø­ÙØ¸ Ø§Ù„Ø¯Ø§Ø¦Ù…
                alert("âœ… ØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ« ÙˆØ§Ù„Ø­ÙØ¸ Ø¨Ù†Ø¬Ø§Ø­! Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª Ù„Ù† ØªÙ†Ù…Ø³Ø­ Ø£Ø¨Ø¯Ø§Ù‹.");
                render();
            } catch (e) { alert("âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ÙƒÙˆØ¯: " + e.message); }
        };

        // Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„ØªØ·ÙˆÙŠØ±Ø§Øª Ø¹Ù†Ø¯ Ø§Ù„ØªØ´ØºÙŠÙ„
        window.addEventListener('load', () => {
            const savedCode = localStorage.getItem(DEV_KEY);
            if(savedCode) {
                document.getElementById('dev-code-editor').value = savedCode;
                try { new Function(savedCode)(); render(); } catch(e) {}
            }
        });

        render();
    </script>
</body>
</html>
